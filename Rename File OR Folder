	

    ;EXAMPLE
    MsgBox, % Rename(A_Desktop "\a\*.*", "*.txt")
     
     
     
     
    FileRename($filename,$newname, $flags:="0"){
	IfNotExist, % $filename, return, 0
		
	StringReplace, $newname, $newname,:, % " -",All
	StringReplace, $newname, $newname,<,(,All
	StringReplace, $newname, $newname,>,),All
	StringReplace, $newname, $newname,/,,All
	StringReplace, $newname, $newname,\,,All
	StringReplace, $newname, $newname,?,,All
	StringReplace, $newname, $newname,",',All
	StringReplace, $newname, $newname,|,,All
	
	SplitPath, $filename, , $filedir

	if ($flags)
		Run, %comspec% /c Ren "%$filename%" "%$newname%",, Hide UseErrorLevel
		if not ErrorLevel
			return 1
		
	if IsFile($filename)
	{
		FileMove, %$filename%, %$filedir%\%$newname%,1
		if ErrorLevel
			FileMove, %$filename%, %$newname%,1
	} 
	else
		FileMoveDir, %$filename%, %$filedir%\%$newname%, R

	
	return ErrorLevel ? 0 : 1
}
     
     
    IsFile(subcomandname:=""){
            FileGetAttrib, Attributes_Check, % subcomandname
            If (!InStr(Attributes_Check,"D"))
                    return 1 ;es archivo
            If (InStr(Attributes_Check,"D"))
                    return 0 ;es carpeta
    }      
    SplitPath($source, $flags:="1"){
    SplitPath, $source, $OutFileName, $OutDir, $OutExtension, $OutNameNoExt, $OutDrive
            return $flags = "1" ? $OutFileName :  $flags = "2" ? $OutDir :  $flags = "3" ? $OutExtension : $flags = "4" ? $OutNameNoExt : $OutDrive
    }

